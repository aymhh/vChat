<!DOCTYPE html>

<html>

<head>
	<title>vChat - Official Website</title>
	<meta name="description" content="SAT Project">
	<meta property="og:title" content="vChat - Official Website">
	<meta property="og:site_name" content="vChat">
	<meta property="og:description" content="SAT Project">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta charset="utf-8">
	<link rel="stylesheet" href="css/stylesheet.css">
	<script src="https://unpkg.com/localbase/dist/localbase.dev.js"></script>
	<script src="https://code.jquery.com/jquery-3.4.1.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.js"></script>
	<link rel="icon" type="image/png" href="./assets/images/favicon.jpg">

</head>

<body>
	
	<img src="./assets/images/vchatLogo.png" style="position:absolute; top: 5%; right: 3%;" width="10.3%" alt="vChatLogo">

  

	<div class="container">
		<div class="videoElements">
			<div class="host" id="host">
				<p class="subtext" id="hostTitle">host: </p>
				<img src="./assets/images/" alt="">
				<img class="hostBGChat" id="hostBGChat" src="https://media.discordapp.net/attachments/846374789156831272/865178398045110272/defaultCharacter.png" width="150" height="360" alt="hostBGChat">
					<img class="hostIconChat" id="hostIconChat" src="https://media.discordapp.net/attachments/846374789156831272/865178398045110272/defaultCharacter.png" width="150" height="150" alt="hostIconChat">
				<video poster="./assets/images/cameraDisabled.png" class="hostStream"  id="hostStream" autoplay playsinline width="640px" height="360px" ></video>
				
			</div> 
	
			<div class="guest" id="guest">
				<p class="subtext" id="guestTitle">guest: </p>
				<video poster="./assets/images/cameraDisabled.png" class="guestStream" id="guestStream" autoplay playsinline width="640px" height="360px"></video>
				<img class="guestBGChat" id="guestBGChat" src="https://media.discordapp.net/attachments/846374789156831272/865178398045110272/defaultCharacter.png" width="150" height="360" alt="cameraIcon">
					<img class="guestIconChat" id="guestIconChat" src="https://media.discordapp.net/attachments/846374789156831272/865178398045110272/defaultCharacter.png" width="150" height="150" alt="cameraIcon">
	
			</div>
		</div>
	</div>

	<div class="utilities">
		<button class="muteFunction" id="muteFunction" title="you are currenly unmuted! click here if you want to be muted!">
			<img class="micImage" id="micImage" src="./assets/images/micOpenLogo.png"  alt="micIcon" height="100" width="100">
		</button>

		<button class="hangupButton" id="hangupButton" title="click here to open the chatbox for this room!">
			<img disabled class="endImage" id="endImage" src="./assets/images/hangUp.png" alt="hangUp" height="100" width="100">
		</button>

		<button class="camFunction" id="camFunction" title="your camera is currenly on! click here if you want to turn it off!">
			<img class="camImage" id="camImage" src="./assets/images/cameraOnLogo.png" alt="camIcon" height="100" width="100">
		</button>
	</div>

	<div class="callConstructorContainer">
		<div class="constructorElements">
			<div id="st-box">
				<label class="startupBoxes">allow media access</label>
				<p class="subtext" style="color: black;">you <u>must</u> allow access to your webcam and microphone</p>
				<button class="bufferBoxes" style="border-radius: 25px 25px 0 0; width: 50%; height: 10%;">generate</button>
				<button class="startupBoxesButton" id="webcamButton">give access</button>
				<button class="bufferBoxes" style="border-radius: 25px 25px 0 0; width: 50%; height: 10%;">generate</button>

			</div>
	
			<div id="nd-box">
				<label class="startupBoxes">create room id</label>
				<p class="subtext" style="color: black;">generate an id to invite users with</p>
				<button disabled class="startupBoxesButton" id="callButton" style="border-radius: 25px 25px 0 0; width: 50%; height: 10%;">generate</button>
				<input class="startupBoxesButton" type="text" id="callInput" placeholder=". . ." required readonly> 
				<button class="bufferBoxes" style="border-radius: 25px 25px 0 0; width: 50%; height: 10%;"> </button>
				
			</div>
	
			<div id="rd-box">
				<label class="startupBoxes">join room</label>
				<p class="subtext" style="color: black;">if you have a chatroom id input it here join it</p>
				<button class="bufferBoxes" style="border-radius: 25px 25px 0 0; width: 50%; height: 10%;">generate</button>
				<input class="startupBoxesButton" type="text" id="joinCallInput" placeholder="input here..." required>
				<button disabled class="startupBoxesButton" id="joinFunction" style="border-radius: 0 0 25px 25px; width: 50%; height: 10%;">join</button>
	
			</div>
		</div>
	</div>





	<script>

		const db = new Localbase("vChatDataBase");
		const pageCookie = Cookies.get('cookieUsername');

		db.collection('users').doc({ username: pageCookie }).get().then(doc => {
			document.getElementById("hostIconChat").src = doc[`icon`];
			document.getElementById("hostBGChat").src = doc[`icon`];
			document.getElementById("hostTitle").innerText = `host: ${doc[`username`]}`
		})		

		// mic button
		const muteButton = document.getElementById("muteFunction")
		muteButton.addEventListener("click", function (e) {
			const micOpen = "micOpenLogo.png"
			const micClose = "micClosedLogo.png"
			let micImageSrc = document.getElementById("micImage").src
			if(micImageSrc.endsWith(micOpen)){
				document.getElementById("muteFunction").title = "you are currenly muted! click here if you want to be unmuted!"
				return document.getElementById("micImage").src = `./assets/images/${micClose}`
			} else if (micImageSrc.endsWith(micClose)) {
				document.getElementById("muteFunction").title = "you are currenly unmuted! click here if you want to be muted!"
				return document.getElementById("micImage").src = `./assets/images/${micOpen}`
			}
		});
		

		// camera button
		const cameraButton = document.getElementById("camFunction")
		cameraButton.addEventListener("click", function (e) {
			const camOpen = "cameraOnLogo.png"
			const camClose = "cameraOffLogo.png"
			let camImageSrc = document.getElementById("camImage").src
			
			if(camImageSrc.endsWith(camOpen)){
				cameraButton.title = "your camera is currenly off! click here if you want to turn it on!"
				return document.getElementById("camImage").src = `./assets/images/${camClose}`
			} else if (camImageSrc.endsWith(camClose)) {
				cameraButton.title = "your camera is currenly on! click here if you want to turn it off!"
				return document.getElementById("camImage").src = `./assets/images/${camOpen}`
			}
		});

	</script>

	<script type="module" src="/main.js"></script>


</body>

</html>
