<!DOCTYPE html>

<html>

<head>
  <title>vChat - Login Page</title>
  <meta name="description" content="SAT Project">
  <meta property="og:title" content="vChat - Official Website">
  <meta property="og:site_name" content="vChat">
  <meta property="og:description" content="SAT Project">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8">
  <link rel="stylesheet" href="css/stylesheet.css">
  <script src="https://unpkg.com/localbase/dist/localbase.dev.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.js" 
          integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" 
          crossorigin="anonymous">
  </script>
	<link rel="icon" type="image/png" href="./assets/images/favicon.jpg">




<body>

  <div class="logo2">
    <a href="./index.html">
      <img src="./assets/images/vchatLogo.png" style="position:absolute; top: 5%; left: 3%;" width="10.3%"
        alt="vChatLogo">
    </a>
  </div>


  <form id="signUpForm" class="loginContainer" style="height: 79%;" method="GET" action="./profilePage.html">

    <label class="headerBarLogin">
      <b>sign up<b>
    </label>

    <div class="loginBarFonts" style="top: 4.5%;">
      <i><abbr title="Since this is a demo, you can use websites such as 10minutesmail">email address</abbr><i>
    </div>

    <input class="loginBar" id="email" type="email" placeholder=". . ." required style="margin-top: 7%;">
    </input>

    <div class="loginBarFonts" style="top: 4%;">
      <i><abbr
          title="Your username must be between 4-16 characters, numbers and special characters (! @ # ?) are accepted.">username</abbr><i>
    </div>

    <input  class="loginBar" 
            id="uid" 
            placeholder=". . ." 
            minlength="4" 
            required 
            style="margin-top: 6%;">
    </input>

    <div class="loginBarFonts" style="top: 4%;">
      <i><abbr
          title="Your password must be between 6-16 characters, numbers and special characters (! @ # ?) are accepted.">password</abbr><i>
    </div>

    <input  class="loginBar" 
            id="pwd" 
            autocomplete="on" 
            type="password" 
            minlength="6" 
            placeholder=". . ." 
            required
            style="margin-top: 6%;">
    </input>

    <script>
      const loginButton = document.getElementById("signUpForm");
      const email = document.getElementById("email");
      const username = document.getElementById("uid");
      const password = document.getElementById("pwd");
      const db = new Localbase("vChatDataBase")
      db.config.debug = false

       
      loginButton.addEventListener('submit', function (e) {

        e.preventDefault();

        if(username.value.includes())

        db.collection('users').doc({ username: username.value }).get().then(document => {
        if(document === undefined) {
          db.collection('users').add({
             email: email.value,
             username: username.value,
             password: password.value,
             icon: "https://cdn.discordapp.com/attachments/846374789156831272/865178398045110272/defaultCharacter.png"
           }, username.value)

            Cookies.set('cookieUsername', username.value)
            return window.location.href = './profilePage.html'
          } else {
            alert("An account with this username already exists. Please pick a different username.")
          }
        })
      })
    </script>
    
    <button type="submit" id="loginButton" class="loginButton" style="margin-top: 8%;" >login!</button>

  </form>

</body>

</html>
